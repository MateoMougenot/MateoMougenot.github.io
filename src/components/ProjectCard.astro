---
const { id, title, role, image, slug, tools } = Astro.props;

// Parse tools string en array
const toolsArray = tools ? tools.split(",").map((t: string) => t.trim()).filter((t: string) => t.length > 0) : [];
---

<a
  href={`/projects/${slug}`}
  class="group relative overflow-hidden rounded-2xl aspect-[16/10] bg-black/20 cursor-pointer reveal block"
  aria-label={`Voir le projet ${title}`}
>
  <!-- Image -->
  <div class="absolute inset-0 overflow-hidden">
    <img
      src={image}
      alt={title}
      class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
      loading="lazy"
    />
    <div class="absolute inset-0 bg-gradient-to-t from-black via-black/40 to-transparent opacity-80 group-hover:opacity-60 transition-opacity duration-300" />
  </div>

  <!-- Hover glass overlay -->
  <div class="absolute inset-x-6 bottom-6 p-6 bg-white/10 backdrop-blur-xl border border-white/20 rounded-xl opacity-0 group-hover:opacity-100 transition-all duration-300">
    <div class="flex items-start justify-between gap-4 mb-4">
      <div>
        <h3 class="text-white mb-2 tracking-tight text-[clamp(1.25rem,2.5vw,1.75rem)]">{title}</h3>
        <p class="text-white/70 text-sm">{role}</p>
      </div>

      <div class="flex-shrink-0 w-10 h-10 bg-white/20 rounded-full flex items-center justify-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M7 17L17 7" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M7 7h10v10" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
    </div>

    <!-- Tools Tags -->
    {toolsArray.length > 0 && (
      <div class="flex gap-2 flex-wrap pt-4 border-t border-white/10">
        {toolsArray.map((tool) => (
          <span class="text-xs px-3 py-1.5 rounded-full bg-white/15 text-white/85 border border-white/25 font-medium hover:bg-white/25 transition-colors">
            {tool}
          </span>
        ))}
      </div>
    )}
  </div>

  <!-- Permanent info -->
  <div class="absolute inset-x-6 bottom-6 group-hover:opacity-0 transition-opacity duration-300 p-6">
    <h3 class="text-white mb-2 tracking-tight text-[clamp(1.25rem,2.5vw,1.75rem)]">{title}</h3>
    <p class="text-white/70 text-sm">{role}</p>
  </div>
</a>
